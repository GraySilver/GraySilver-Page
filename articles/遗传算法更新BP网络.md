## 遗传算法更新BP网络

### 遗传算法(Genetic Algorithms)

遗传算法的基本要素包括**染色体编码方法、适应度函数、遗传操作和运行参数**。

其中染色体编码方法是指个体的编码方法，目前主要包括二进制法、实数法等。二进制法是指把个体编码成一个二进制串，实数法是指把个体编码成一个实数串。

适应度函数是指根据进化目标编写的计算个体适应度值得函数，通过适应度函数计算每一个个体的适应度值，提供给选择算子进行选择。

遗传操作是指**选择、交叉、和变异**。

运行参数是遗传算法在初始化时确定的参数，主要包括群体大小$M$，遗传代数$G$，交叉概率$P_c$和变异概率$P_m$

#### 基本操作

**1.选择操作：**是指从旧的群体中以一定的概率选择个体到新的群体中，个体被选中的概率是跟适应度值有关，个体适应度值越好，被选中的概率越大。

**2.交叉操作：**是指从个体中选择两个个体，通过两个染色体的狡猾组合，来查省心的优秀个体。交叉过程为从种群中任选两个染色体，随机选择一点或多点染色体未知进行交换。

**3.变异操作：**是指从种群中任选一个个体，选择染色体的一点进行变异以产生更优秀的个体。

遗传算法具有高效启发式搜索、并行计算等特点，目前已经应用在函数优化、组合优化以及生产调度等方面。

#### 算法流程

**1.种群初始化：**个体编码方法为实数编码，每隔个体均为一个实数串，由输入层和隐含层连接权值、隐含层阈值、隐含层与输出层连接权值以及输出层阈值4个部分组成。个体包含了神经网络全部的权值和阈值，在网路结构一直的情况下，就可以构成一个结构、权值、阈值确定的神经网络。

**2.适应度函数 ：**根据个体得到BP神经网络的初始权值和阈值，用训练数据训练BP神经网络后预测系统输出，把预测输出个期望的输出之间的误差绝对值和$E$作为个体适应度值$F$计算公式为 

![](http://graysliver.oss-cn-shenzhen.aliyuncs.com/ga0.JPG)

上面式子中，n为网络输出节点数，$y_i$为BP神经网络第i个节点的期望输出$o_i$为第i个节点的实际输出，k为系数。

**3.选择操作 ：**遗传算法选择操作有轮盘赌法、锦标赛法等多种方法。选择轮盘赌法时，即基于适应度比例的选择策略，每个个体i的选择概率$p_i$为：

![](http://graysliver.oss-cn-shenzhen.aliyuncs.com/ga1.JPG)

式中，$F_i$为个体i的适应度值，由于适应度值越小越好，所以在个体选择前对适应度求倒数；k为系数；N为种群个体数目。

**4.交叉操作 ：**由于个体采用实数编码，所以交叉操作方法采用实数交叉法，第$k$个染色体$a_k$和第$l$个染色体$a_l$在$j$的交叉操作方法如下：

![](http://graysliver.oss-cn-shenzhen.aliyuncs.com/ga2.JPG)

式中，b是[0,1]之间的随机数。

**5.变异操作：**选取第$i$个个体的第$j$个基因$a_{ij}$进行变异变异操作方法如下： 

![](http://graysliver.oss-cn-shenzhen.aliyuncs.com/ga4.JPG)

### GA更新BP的具体流程

![](http://graysliver.oss-cn-shenzhen.aliyuncs.com/ga.png)