## 基于内容推荐(CB)的推荐算法

#### 内容推荐？

很多人肯定经常接触推荐系统应用的产品，例如今日头条，网易云音乐，还有银魂等。:）就目前看，Collaborative Filtering Recommendations (协同过滤，简称CF) 还是目前最流行的推荐方法，在研究界和工业界得到大量使用。但是，工业界真正使用的系统一般都不会只有CF推荐算法，Content-based Recommendations (基于内容推荐，CB) 基本也会是其中的一部分。

**CB根据用户过去喜欢的产品(items)，为用户推荐和他过去喜欢的产品相似的产品**。例如，一个推荐饭店的系统可以依据某个用户之前喜欢很多的烤肉店而为他推荐烤肉店。 CB最早主要是应用在信息检索系统当中，所以很多信息检索及信息过滤里的方法都能用于CB中。

#### 推荐过程

CB的推荐过程一般包括下面三步：

- **Item Representation**：即对items做特征工程，通俗来说即对items的属性表达出来，如item = 农夫山泉(品类：矿泉水，价格：1-5，etc)；
- **Profile Learning**：利用一个用户(id)过去喜欢(以及不喜欢)的item的特征数据，来学习出此用户的喜好特征(profile)，如id=我，喜欢=(农夫山泉，麦当劳)，不喜欢=(槟榔，香烟)，etc。
- **Recommendation Generation**：通过比较上一步得到的用户profile与候选item的特征，为此用户推荐一组相关性最大的item。

![机器学习：详解基于内容推荐(CB)的推荐算法](http://p3.pstatp.com/large/39b00002813e5eaf6097)

#### 一个简单的例子

对于个性化阅读来说，一个item就是一篇文章，第一步我们要提取文章中的关键词组来表示文章的主题，可以采用的方法例如TF-IDF找文章中词的权重，例如在python文章中“python”是主要被提及的字眼，那么该词是关键字，利用这种方法，我们就可以把文章向量化。第二步是找出用户之前喜欢的文章，通过上述TF-IDF方法，将其向量化，然后求平均值，来代表用户大致喜欢的文章。如果用户喜欢python语言，那么该用户的profile中['python']的权重占比较大。第三步就是通过以上二步得到的所有item和该用户的profile进行匹配，计算方式一般用余弦相似度。

#### 详细过程

**1.Item Representation**

Item一般都会有一些描述它的属性。这些属性通常可以分为两种：结构化(structured)和非结构化(unstructured)属性。所谓结构化属性就是可以被量化，可直接使用的属性，如人有性别、学历、地域等属性。而非结构化属性就是需要再进行二次解析，无法直接利用的属性，如人的购买记录，一篇文章的内容等。像文章这种非结构化数据可以利用TF-IDF和word2vec等算法把文章中的关键词向量化表示出来。

如果用TF-IDF表示文章对应关键词的权重，那么可以得到以下矩阵：

![机器学习：详解基于内容推荐(CB)的推荐算法](http://p3.pstatp.com/large/39b700007ae6eaec647a)

**2.Profile Learning**

假设用户(id)已经对一些item做出了喜欢的判断，对另一部分item做出了不喜欢的判断，且这些item我们已经有了对应的向量化表示，那么这就是用户的profile，如何简单计算用户的profile呢？公式如下：

![机器学习：详解基于内容推荐(CB)的推荐算法](http://p1.pstatp.com/large/39b300027e3e4e18e49b)

其中x是用户喜欢的item，a是喜欢item的总数，y是用户不喜欢的item，b是不喜欢item的总数。这时我们得到另一个用户矩阵：(当然这里不是协同过滤，无需把全部用户列成矩阵项，实际应用单个用户id即可)

![机器学习：详解基于内容推荐(CB)的推荐算法](http://p9.pstatp.com/large/39b60000977401b09749)

**3.Recommendation Generation**

通过以上二步得到的所有item和所有用户的profile，那么要对一个用户的profile和所有item进行匹配，此时我们计算的方式一般用余弦相似度。余弦相似度的计算方法如下，假设向量a、b的坐标分别为(x1,y1)、(x2,y2) 。则：

![机器学习：详解基于内容推荐(CB)的推荐算法](http://p1.pstatp.com/large/39ad00025a478f5bc854)

余弦值的范围在[-1,1]之间，值越趋近于1，代表两个向量的方向越接近；越趋近于-1，他们的方向越相反。如上述例子我们可以计算以下结果：

![机器学习：详解基于内容推荐(CB)的推荐算法](http://p9.pstatp.com/large/39b300027ec0d171cca8)

所以最终会把余弦值最大(跟用户最相关的文章)的前N篇推荐给用户。

#### 优缺点

优点：可以使用当前的用户评价来构建用户的个人信息；由于过程简单解释性强，推荐的结果容易被人接受；对于新物品来没有任何用户评分的也可以推荐给用户。

缺点：可分析的内容有限，且新颖度较差，新用户需要用户的偏好信息，无法解决冷启动问题。
